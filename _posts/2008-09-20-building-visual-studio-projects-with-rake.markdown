---
title: Building Visual Studio Projects with Rake
tags: tech
layout: post
---
We are building a Rails applicaiton that has a C++ client developed under windows, and needed a nice way to script things.  Since the web side of the project was in rails it seemed natural to use rake to build the C++ stuff.  Pretty simple, but in order for the devenv to get loaded we had to load some of the envorment varables up for rake. Once that was done everyting has been easy.<br /><br />My Rakefile:<br /><pre><br /># Visual Studio 2008 Environment Settings:<br />ENV["VSINSTALLDIR"] = 'C:\Program Files\Microsoft Visual Studio 9.0'<br />ENV["VCINSTALLDIR"] = 'C:\Program Files\Microsoft Visual Studio 9.0\VC'<br />ENV["DevEnvDir"] = 'C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE'<br />ENV["PATH"] = 'C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE;C:\Program Files\Microsoft Visual Studio 9.0\VC\BIN;C:\Program Files\Microsoft Visual Studio 9.0\Common7\Tools;C:\WINDOWS\Microsoft.NET\Framework\v3.5;C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727;C:\Program Files\Microsoft Visual Studio 9.0\VC\VCPackages;' + ENV["PATH"]<br />ENV["INCLUDE"] = 'C:\Program Files\Microsoft Visual Studio 9.0\VC\ATLMFC\INCLUDE;C:\Program Files\Microsoft Visual Studio 9.0\VC\INCLUDE;C:\Program Files\boost\boost_1_35_0'<br />ENV["LIB"] = 'C:\Program Files\Microsoft Visual Studio 9.0\VC\ATLMFC\LIB;C:\Program Files\Microsoft Visual Studio 9.0\VC\LIB;C:\Program Files\boost\boost_1_35_0\lib'<br />ENV["LIBPATH"] = 'C:\WINDOWS\Microsoft.NET\Framework\v3.5;C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727;C:\Program Files\Microsoft Visual Studio 9.0\VC\ATLMFC\LIB;C:\Program Files\Microsoft Visual Studio 9.0\VC\LIB'<br /><br /># WiX Environment Settings<br />WIX_PATH="\"C:/Program Files/Windows Installer XML v3/bin\""<br />CANDLE= WIX_PATH + "candle"<br />LIGHT = WIX_PATH + "light"<br /><br />desc "Build the project in release"<br />task 'release' do<br />  system 'VCBuild path/to/project.vcproj  Release /rebuild /nologo'<br />end<br /><br />task :default => [:release]<br /></pre>
